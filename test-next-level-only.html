<!DOCTYPE html>
<html lang="en">
<head>
    <meta charset="UTF-8">
    <meta name="viewport" content="width=device-width, initial-scale=1.0">
    <title>Test Next Level Only Functionality</title>
    <link rel="stylesheet" href="css/main.css">
    <link rel="stylesheet" href="css/screens.css">
    <link rel="stylesheet" href="css/ui-components.css">
</head>
<body>
    <div class="game-container">
        <!-- Test Game Screen -->
        <div id="game-screen" class="screen" style="display: flex !important;">
            <div class="game-header">
                <div class="game-stats">
                    <div class="stat">
                        <span class="stat-label">SECTION:</span>
                        <span class="stat-value" id="current-section">PASSWORD</span>
                    </div>
                    <div class="stat">
                        <span class="stat-label">LEVEL:</span>
                        <span class="stat-value" id="current-level">1</span>
                    </div>
                    <div class="stat">
                        <span class="stat-label">NEXT LEVEL:</span>
                        <span class="stat-value" id="next-level">2</span>
                    </div>
                </div>
                <div class="header-controls">
                    <div class="music-panel" id="music-panel">
                        <div class="music-info">
                            <span class="music-status" id="music-status">‚ô™ Music</span>
                            <span class="music-volume" id="music-volume-indicator">30%</span>
                        </div>
                        <div class="music-buttons">
                            <button class="btn-icon" id="music-play-pause" title="Play/Pause Music">‚è∏Ô∏è</button>
                            <button class="btn-icon" id="music-volume-btn" title="Volume Control">üîä</button>
                        </div>
                    </div>
                    <div class="game-nav-buttons">
                        <button class="btn" data-action="back-to-levels">BACK TO LEVELS</button>
                        <button class="btn" data-action="pause">PAUSE</button>
                        <button class="btn btn-primary" data-action="next-level" id="next-level-btn">CONTINUE</button>
                    </div>
                </div>
            </div>

            <div class="game-content">
                <div class="puzzle-area" id="puzzle-area">
                    <div style="text-align: center; padding: 30px; color: var(--text-secondary);">
                        <h3 id="level-title">Password Cracking - Level 1</h3>
                        <p id="level-desc">Test that Continue button ONLY goes to next level</p>
                        <br>
                        
                        <div style="margin: 20px 0; padding: 20px; background: var(--panel-bg); border: 2px solid var(--cyber-blue);">
                            <h4 style="color: var(--cyber-blue); margin-bottom: 15px;">Test Next Level Only</h4>
                            
                            <div style="margin: 15px 0;">
                                <h5 style="color: var(--cyber-green);">Password Section Test:</h5>
                                <button class="btn btn-small" onclick="testSection('password', 1, 3)" style="margin: 3px;">Level 1‚Üí2</button>
                                <button class="btn btn-small" onclick="testSection('password', 2, 3)" style="margin: 3px;">Level 2‚Üí3</button>
                                <button class="btn btn-small" onclick="testSection('password', 3, 3)" style="margin: 3px;">Level 3 (Last)</button>
                            </div>
                            
                            <div style="margin: 15px 0;">
                                <h5 style="color: var(--cyber-pink);">Malware Section Test:</h5>
                                <button class="btn btn-small" onclick="testSection('malware', 1, 2)" style="margin: 3px;">Level 1‚Üí2</button>
                                <button class="btn btn-small" onclick="testSection('malware', 2, 2)" style="margin: 3px;">Level 2 (Last)</button>
                            </div>
                            
                            <div style="margin: 15px 0;">
                                <h5 style="color: var(--cyber-purple);">Network Section Test:</h5>
                                <button class="btn btn-small" onclick="testSection('network', 1, 7)" style="margin: 3px;">Level 1‚Üí2</button>
                                <button class="btn btn-small" onclick="testSection('network', 6, 7)" style="margin: 3px;">Level 6‚Üí7</button>
                                <button class="btn btn-small" onclick="testSection('network', 7, 7)" style="margin: 3px;">Level 7 (Last)</button>
                            </div>
                            
                            <div style="margin: 20px 0; padding: 15px; background: var(--darker-bg); border: 1px solid var(--cyber-green);">
                                <h5 style="color: var(--cyber-green);">‚úÖ Expected Behavior:</h5>
                                <ul style="text-align: left; color: var(--text-secondary); margin: 10px 0; font-size: 0.9rem;">
                                    <li><strong>Continue Button:</strong> Only advances to next level in same section</li>
                                    <li><strong>Never:</strong> Redirects to category selection screen</li>
                                    <li><strong>Last Level:</strong> Button is hidden completely</li>
                                    <li><strong>Section Independence:</strong> Each section progresses separately</li>
                                </ul>
                            </div>
                        </div>
                        
                        <div id="test-log" style="margin: 20px 0; padding: 15px; background: var(--darker-bg); border: 1px solid var(--text-secondary); text-align: left; max-height: 200px; overflow-y: auto;">
                            <strong style="color: var(--cyber-blue);">Test Log:</strong><br>
                            <span style="color: var(--text-muted);">Click test buttons above to verify behavior...</span>
                        </div>
                    </div>
                </div>

                <div class="side-panel">
                    <div class="panel">
                        <div class="panel-title">Current Test</div>
                        <div id="current-test" style="color: var(--text-secondary); padding: 10px; font-size: 0.9rem;">
                            Section: <span id="test-section">-</span><br>
                            Current Level: <span id="test-level">-</span><br>
                            Max Level: <span id="test-max">-</span><br>
                            Is Last Level: <span id="test-is-last">-</span><br>
                            Has Next Level: <span id="test-has-next">-</span>
                        </div>
                    </div>

                    <div class="panel">
                        <div class="panel-title">Continue Button State</div>
                        <div id="button-test" style="color: var(--text-secondary); padding: 10px; font-size: 0.9rem;">
                            Visible: <span id="btn-visible">-</span><br>
                            Enabled: <span id="btn-enabled">-</span><br>
                            Text: <span id="btn-text">-</span><br>
                            Expected Action: <span id="btn-expected">-</span>
                        </div>
                    </div>

                    <div class="panel">
                        <div class="panel-title">Test Results</div>
                        <div id="test-results" style="color: var(--text-secondary); padding: 10px; font-size: 0.9rem;">
                            <div id="results-summary">No tests run yet</div>
                        </div>
                    </div>
                </div>
            </div>
        </div>
    </div>

    <script>
        let testResults = [];

        function log(message, type = 'info') {
            const logDiv = document.getElementById('test-log');
            const timestamp = new Date().toLocaleTimeString();
            const color = type === 'success' ? 'var(--cyber-green)' : 
                         type === 'error' ? 'var(--cyber-pink)' : 
                         type === 'warning' ? 'var(--cyber-orange)' : 'var(--text-secondary)';
            
            logDiv.innerHTML += `<br><span style="color: var(--text-muted);">[${timestamp}]</span> <span style="color: ${color};">${message}</span>`;
            logDiv.scrollTop = logDiv.scrollHeight;
        }

        function testSection(section, level, maxLevel) {
            const isLastLevel = level === maxLevel;
            const hasNextLevel = level < maxLevel;
            const nextLevel = level + 1;
            
            // Update display
            document.getElementById('current-section').textContent = section.toUpperCase();
            document.getElementById('current-level').textContent = level;
            document.getElementById('next-level').textContent = hasNextLevel ? nextLevel : 'NONE';
            document.getElementById('level-title').textContent = `${section.charAt(0).toUpperCase() + section.slice(1)} - Level ${level}`;
            document.getElementById('level-desc').textContent = isLastLevel ? 
                'This is the LAST level - Continue button should be HIDDEN' : 
                `Continue should go to Level ${nextLevel} in ${section.toUpperCase()} section`;
            
            // Update test info
            document.getElementById('test-section').textContent = section.toUpperCase();
            document.getElementById('test-level').textContent = level;
            document.getElementById('test-max').textContent = maxLevel;
            document.getElementById('test-is-last').textContent = isLastLevel ? 'YES' : 'NO';
            document.getElementById('test-has-next').textContent = hasNextLevel ? 'YES' : 'NO';
            
            // Simulate continue button behavior
            const continueBtn = document.getElementById('next-level-btn');
            
            if (isLastLevel) {
                // Last level - hide button
                continueBtn.style.display = 'none';
                document.getElementById('btn-visible').textContent = 'NO';
                document.getElementById('btn-enabled').textContent = 'N/A';
                document.getElementById('btn-text').textContent = 'HIDDEN';
                document.getElementById('btn-expected').textContent = 'Button should be hidden';
                
                log(`‚úÖ CORRECT: Level ${level} is last level - Continue button hidden`, 'success');
                testResults.push({ section, level, expected: 'hidden', actual: 'hidden', passed: true });
                
            } else {
                // Not last level - show active button
                continueBtn.style.display = 'inline-block';
                continueBtn.disabled = false;
                continueBtn.textContent = 'CONTINUE';
                
                document.getElementById('btn-visible').textContent = 'YES';
                document.getElementById('btn-enabled').textContent = 'YES';
                document.getElementById('btn-text').textContent = 'CONTINUE';
                document.getElementById('btn-expected').textContent = `Go to ${section.toUpperCase()} Level ${nextLevel}`;
                
                log(`‚úÖ CORRECT: Level ${level} - Continue button active for next level`, 'success');
                testResults.push({ section, level, expected: `level_${nextLevel}`, actual: `level_${nextLevel}`, passed: true });
            }
            
            updateTestResults();
        }

        function updateTestResults() {
            const resultsDiv = document.getElementById('results-summary');
            const totalTests = testResults.length;
            const passedTests = testResults.filter(r => r.passed).length;
            
            resultsDiv.innerHTML = `
                <strong style="color: var(--cyber-blue);">Tests Run: ${totalTests}</strong><br>
                <strong style="color: var(--cyber-green);">Passed: ${passedTests}</strong><br>
                <strong style="color: var(--cyber-pink);">Failed: ${totalTests - passedTests}</strong><br>
                <strong>Success Rate: ${totalTests > 0 ? Math.round((passedTests / totalTests) * 100) : 0}%</strong>
            `;
        }

        // Test continue button click
        document.addEventListener('click', (e) => {
            const btn = e.target.closest('[data-action]');
            if (!btn) return;
            
            const action = btn.dataset.action;
            
            switch (action) {
                case 'back-to-levels':
                    const section = document.getElementById('current-section').textContent.toLowerCase();
                    log(`üîô Back to Levels clicked - would return to ${section.toUpperCase()} level selection`, 'info');
                    alert(`Would return to ${section.toUpperCase()} level selection screen`);
                    break;
                    
                case 'pause':
                    log('‚è∏Ô∏è Pause clicked - would pause the game', 'info');
                    alert('Would pause the game');
                    break;
                    
                case 'next-level':
                    if (btn.style.display === 'none') {
                        log('‚ùå ERROR: Continue button clicked but it should be hidden!', 'error');
                        alert('ERROR: Button should be hidden on last level!');
                        return;
                    }
                    
                    const currentSection = document.getElementById('current-section').textContent.toLowerCase();
                    const currentLevel = parseInt(document.getElementById('current-level').textContent);
                    const nextLevel = currentLevel + 1;
                    
                    log(`üöÄ Continue clicked - would load ${currentSection.toUpperCase()} Level ${nextLevel}`, 'success');
                    alert(`SUCCESS: Would load ${currentSection.toUpperCase()} Level ${nextLevel}\n\nThis is the CORRECT behavior - no redirect to category menu!`);
                    
                    // Simulate going to next level
                    testSection(currentSection, nextLevel, 
                        currentSection === 'password' ? 3 : 
                        currentSection === 'malware' ? 2 : 7);
                    break;
            }
        });

        // Initialize
        log('üéÆ Test initialized - select a test scenario above', 'info');
    </script>
</body>
</html>
</text>
</invoke>